

/* web/kiwi/admin_sdr.min.js */
var sdr_hu_interval,ext_cur_nav,admin_sdr={pmi:0,pbm:"am",pbl:0,pbh:0,pbc:0,pbw:0,pbc_lock:!1,pb:{am:{c:0,w:9800},amn:{c:0,w:5e3},usb:{c:1500,w:2400},usn:{c:1350,w:2100},lsb:{c:-1500,w:2400},lsn:{c:-1350,w:2100},cw:{c:500,w:400},cwn:{c:500,w:60},nbfm:{c:0,w:12e3},iq:{c:0,w:1e4},drm:{c:0,w:1e4},sam:{c:0,w:9800},sau:{c:2450,w:9800},sal:{c:-2450,w:9800},sas:{c:0,w:9800},qam:{c:0,w:9800}},dx_enabled:!1,_last_:0},ITU_region_i=["R1: Europe, Africa","R2: North & South America","R3: Asia / Pacific"],AM_BCB_chan_i=["9 kHz","10 kHz"],max_freq_i=["30 MHz","32 MHz"],SPI_clock_i=["48 MHz","24 MHz"],led_brightness_i=["brighest","medium","dimmer","dimmest","off"],clone_host="",clone_pwd="",clone_files_s=["complete config","dx labels only"];function config_html(){kiwi_get_init_settings();var e=ext_get_cfg_param("init.mode",0),i=ext_get_cfg_param("init.colormap",0),n=ext_get_cfg_param("init.aperture",1),a=ext_get_cfg_param("init.AM_BCB_chan",0),_=ext_get_cfg_param("init.ITU_region",0),t=ext_get_cfg_param("max_freq",0),r=(t=ext_get_cfg_param("max_freq",0),"<hr>"+w3_text("w3-margin-B-8 w3-text-teal w3-bold","Initial values for:")+w3_third("w3-margin-bottom w3-text-teal","w3-container",w3_input_get("","Frequency (kHz)","init.freq","admin_float_cb|3"),w3_inline("/w3-halign-space-around/w3-center",w3_select("","Mode","","init.mode",e,kiwi.modes_u,"admin_select_cb"),w3_select("","Colormap","","init.colormap",i,kiwi.cmap_s,"admin_select_cb"),w3_select("","Aperture","","init.aperture",n,kiwi.aper_s,"config_aperture_cb")),w3_div("w3-center w3-tspace-8",w3_select("w3-width-auto","AM BCB channel spacing","","init.AM_BCB_chan",a,AM_BCB_chan_i,"admin_select_cb")))+w3_third("w3-text-teal","w3-container",w3_div("",w3_input_get("id-wf-show-min//","Waterfall min (dBFS, fully zoomed-out)","init.min_dB","config_wfmin_cb"),w3_input_get("id-wf-show-floor//","Waterfall floor (dB)","init.floor_dB","admin_int_cb")),w3_div("",w3_input_get("id-wf-show-max//","Waterfall max (dBFS)","init.max_dB","config_wfmax_cb"),w3_input_get("id-wf-show-ceil//","Waterfall ceil (dB)","init.ceil_dB","admin_int_cb")),w3_input_get("","Zoom (0-14)","init.zoom","config_zoom_cb"))+w3_third("","w3-container",w3_div("id-wfmin-error w3-margin-T-8 w3-red w3-hide","Waterfall min must be < max"),w3_div("id-wfmax-error w3-margin-T-8 w3-red w3-hide","Waterfall max must be > min"),w3_div("id-zoom-error w3-margin-T-8 w3-red w3-hide","Zoom must be 0 to 14"))+w3_div("w3-margin-bottom")),d="<hr>"+w3_text("w3-text-teal w3-bold","Default passbands:")+w3_third("w3-text-teal w3-valign","w3-container",w3_inline("w3-halign-space-around w3-tspace-8/w3-center",w3_button("w3-aqua","Reset","config_pb_reset"),w3_select("w3-label-inline","Mode","","admin_sdr.pbm",admin_sdr.pbm,kiwi.modes_u,"config_pb_mode")),w3_input("","Passband low","admin_sdr.pbl",admin_sdr.pbl,"config_pb_val"),w3_input("","Passband high","admin_sdr.pbh",admin_sdr.pbh,"config_pb_val"))+w3_third("","w3-container","",w3_div("id-pbl-error w3-margin-T-8 w3-yellow w3-hide","Value creates an invalid passband"),w3_div("id-pbh-error w3-margin-T-8 w3-yellow w3-hide","Value creates an invalid passband"))+w3_third("w3-margin-T-16 w3-text-teal","w3-container",w3_divs("/w3-center w3-tspace-8",w3_div("w3-text-black","As each field is changed the others are <br>automatically adjusted. Define CW offset by <br>setting appropriate passband center frequency <br>for CW/CWN modes (typ 500, 800 or 1000 Hz).")),w3_half("w3-valign","",w3_input("","Passband center","admin_sdr.pbc",admin_sdr.pbc,"config_pb_val"),w3_checkbox("w3-halign-center//w3-label-inline","Lock","admin_sdr.pbc_lock",admin_sdr.pbc_lock,"config_pbc_lock")),w3_input("","Passband width","admin_sdr.pbw",admin_sdr.pbw,"config_pb_val"))+w3_third("","w3-container","",w3_div("id-pbc-error w3-margin-T-8 w3-yellow w3-hide","Value creates an invalid passband"),w3_div("id-pbw-error w3-margin-T-8 w3-yellow w3-hide","Value creates an invalid passband"))+w3_div("w3-margin-bottom"),o="<hr>"+w3_third("w3-margin-bottom w3-text-teal","w3-container",w3_div("",w3_input_get("","Frequency scale offset (kHz, 1 Hz resolution)","freq_offset","admin_float_cb|3"),w3_div("w3-text-black","Adds offset to frequency scale. <br> Useful when using a downconverter, e.g. set to <br>116000 kHz when 144-148 maps to 28-32 MHz.")),w3_divs("w3-restart/w3-center w3-tspace-8",w3_select("w3-width-auto","Max receiver frequency","","max_freq",t,max_freq_i,"admin_select_cb"),w3_div("w3-text-black","32 MHz necessary for some downconverters. But note <br>there will be more spurs in the 30-32 MHz range.")),w3_div("",w3_checkbox_get_param("//w3-restart w3-label-inline","Show AGC threshold on S-meter","agc_thresh_smeter","admin_bool_cb",!0),w3_checkbox_get_param("w3-margin-T-8// w3-label-inline","Show user geolocation info","show_geo","admin_bool_cb",!0)))+w3_third("w3-margin-bottom w3-text-teal","w3-container",w3_input_get("","S-meter calibration (dB)","S_meter_cal","admin_int_cb"),w3_divs("/w3-center",w3_slider("","S-meter OV","cfg.S_meter_OV_counts",cfg.S_meter_OV_counts,0,15,1,"config_OV_counts_cb"),w3_text("w3-text-black","Increase if S-meter OV is flashing excessively.")),w3_divs("/w3-center",w3_slider("","Passband overload mute","cfg.overload_mute",cfg.overload_mute,-33,0,1,"overload_mute_cb"),w3_text("w3-text-black","When the signal level in the passband exceeds this level <br>the audio will be muted. The icon "+w3_icon("|padding:0 3px;","fa-exclamation-triangle",20,"yellow|#575757")+" will replace the <br>mute icon in the control panel. Useful for muting when <br>a strong nearby transmitter is active.")))+w3_third("w3-margin-bottom w3-text-teal","w3-container",w3_input_get("","Waterfall calibration (dB)","waterfall_cal","admin_int_cb"),w3_div("w3-center w3-tspace-8",w3_select("w3-width-auto","ITU region","","init.ITU_region",_,ITU_region_i,"admin_select_cb"),w3_div("w3-text-black","Configures LW/NDB, MW and <br> amateur band allocations, etc.")),w3_div("w3-center w3-tspace-8",w3_input_get("","Name/callsign input field max length (16-64)","ident_len","config_ident_len_cb"),w3_div("w3-text-black","Used to limit the number of characters a user can enter into the name/callsign field at the top-right of the page."))),c="<hr>"+w3_third("w3-margin-bottom w3-text-teal","w3-container",w3_divs("w3-restart/w3-center w3-tspace-8",w3_select_get_param("w3-width-auto","SPI clock","","SPI_clock",SPI_clock_i,"admin_select_cb",0),w3_div("w3-text-black","Set to 24 MHz to reduce interference <br> on 2 meters (144-148 MHz).")),w3_divs("w3-restart/w3-center w3-tspace-8",w3_select_get_param("w3-width-auto","Status LED brightness","","led_brightness",led_brightness_i,"admin_select_cb",0),w3_div("w3-text-black","Sets brightness of the 4 LEDs <br> that show status info.")),""),s="<hr>"+w3_div("w3-valign w3-container w3-section",'<header class="w3-container w3-yellow"><h6>Clone configuration from another Kiwi. <b>Use with care.</b> Current configuration is <b><i>not</i></b> saved. This Kiwi immediately restarts after cloning.</h6></header>')+w3_inline_percent("w3-text-teal/w3-container",w3_input("","Clone config from Kiwi host","clone_host","","w3_string_cb","enter hostname (no port number)"),25,w3_input("","Kiwi host root password","clone_pwd","","w3_string_cb","required"),25,w3_select("w3-center//","Config to clone","","clone_files",0,clone_files_s,"w3_num_cb"),15,w3_button("w3-center//w3-red","Clone","config_clone_cb"),10,w3_label("w3-show-inline-block w3-margin-R-16 w3-text-teal","Status:")+w3_div("id-config-clone-status w3-show-inline-block w3-text-black w3-background-pale-aqua",""),25)+w3_inline_percent("w3-margin-bottom w3-text-teal/w3-container","",25,w3_div("w3-center w3-text-black","Either the root password you've explicitly set or the Kiwi device serial number."),25),l="<hr>"+w3_div("w3-valign w3-container w3-section",'<header class="w3-container w3-yellow"><h6>If the Kiwi doesn\'t like your external clock you can still connect (user and admin). However the waterfall will be dark and the audio silent.</h6></header>')+w3_third("w3-margin-bottom w3-text-teal","w3-container",w3_divs("w3-restart/w3-center w3-tspace-8",w3_div("","<b>External ADC clock?</b>"),w3_switch("","Yes","No","ext_ADC_clk",cfg.ext_ADC_clk,"config_ext_clk_sel_cb"),w3_text("w3-text-black w3-center","Set when external 66.666600 MHz (nominal) <br> clock connected to J5 connector/pad.")),w3_divs("w3-restart/w3-tspace-8",w3_input("","External clock frequency (enter in MHz or Hz)","ext_ADC_freq",cfg.ext_ADC_freq,"config_ext_freq_cb"),w3_text("w3-text-black","Set exact clock frequency applied. <br> Input value stored in Hz.")),w3_divs("w3-restart/w3-center w3-tspace-8",w3_div("","<b>Enable GPS correction of ADC clock?</b>"),w3_switch("","Yes","No","ADC_clk_corr",cfg.ADC_clk_corr,"admin_radio_YN_cb"),w3_text("w3-text-black w3-center",'Set "no" to keep the Kiwi GPS from correcting for <br>errors in the ADC clock (internal or external).'))),w="<hr>"+w3_div("w3-container",w3_div("w3-valign",'<header class="w3-container w3-yellow"><h6>To manually adjust/calibrate the ADC clock (e.g. when there is no GPS signal or GPS correction is disabled) follow these steps:</h6></header>'),w3_label("w3-text-teal","<ul><li>Open a normal user connection to the SDR</li><li>Tune to a time station or other accurate signal and zoom all the way in</li><li>Higher frequency shortwave stations are better because they will show more offset than LF/VLF stations</li><li>Click exactly on the signal carrier line in the waterfall</li><li>On the right-click menu select the <i>cal ADC clock (admin)</i> entry</li><li>You may have to give the admin password if not already authenticated</li><li>The adjustment is calculated and the carrier on the waterfall should move to the nearest 1 kHz marker</li><li>Use the fine-tuning controls on the IQ extension panel if necessary</li></ul>"),w3_label("w3-text-teal","You can fine-tune after the above steps as follows:<ul><li>Open IQ display extension</li><li>Set the receive frequency to the exact nominal carrier (e.g. 15000 kHz for WWV)</li><li>Press the <i>40</i> button (i.e. sets mode to AM with 40 Hz passband)</li><li>Set menus: Draw = points, Mode = carrier, PLL = off</li><li>Adjust the gain until you see a point rotating in a circle</li><li>Use the <i>Fcal</i> buttons to slow the rotation as much as possible</li><li>The total accumulated Fcal adjustment is shown</li><li>A full rotation in less than two seconds is good calibration</li></ul>"))+"<hr>",b=adm.firmware_sel==kiwi.RX3_WF3?1:0;console.log("mode_20kHz="+b);var m="DC_offset"+(b?"_20kHz":"")+"_I",p="DC_offset"+(b?"_20kHz":"")+"_Q";return dbgUs&&(w=w+w3_div("w3-section w3-text-teal w3-bold","Development settings")+w3_third("w3-margin-bottom w3-text-teal w3-restart","w3-container",w3_input_get("","I balance (DC offset)",m,"admin_float_cb"),w3_input_get("","Q balance (DC offset)",p,"admin_float_cb"),"")+w3_third("w3-margin-bottom w3-text-teal w3-restart","w3-container",w3_divs("w3-center w3-tspace-8",w3_div("","<b>Increase web server priority?</b>"),w3_switch("","Yes","No","test_webserver_prio",cfg.test_webserver_prio,"admin_radio_YN_cb"),w3_text("w3-text-black w3-center","Set 'no' for standard behavior.")),w3_divs("w3-center w3-tspace-8",w3_div("","<b>New deadline update scheme?</b>"),w3_switch("","Yes","No","test_deadline_update",cfg.test_deadline_update,"admin_radio_YN_cb"),w3_text("w3-text-black w3-center","Set 'no' for standard behavior.")),"")+"<hr>"),w3_div("id-config w3-hide",r+d+o+c+s+l+w)}function config_focus(){console.log("config_focus"),config_pb_mode("",admin_sdr.pmi,!1),config_wf_show()}function config_wf_show(){w3_hide2("id-wf-show-min",0!=cfg.init.aperture),w3_hide2("id-wf-show-max",0!=cfg.init.aperture),w3_hide2("id-wf-show-floor",1!=cfg.init.aperture),w3_hide2("id-wf-show-ceil",1!=cfg.init.aperture)}function config_aperture_cb(e,n,a){a||(i=+n,admin_select_cb(e,n),config_wf_show())}function config_pb_reset(e,i){var n=admin_sdr.pbm;console.log("config_pb_reset mode="+n),admin_sdr.pbc=admin_sdr.pb[n].c,admin_sdr.pbw=admin_sdr.pb[n].w;var a=admin_sdr.pbw/2;admin_sdr.pbh=admin_sdr.pbc+a,admin_sdr.pbl=admin_sdr.pbc-a,admin_sdr.pbc_lock=!1,config_pb_val("pbc",admin_sdr.pbc,!1)}function config_pb_mode(e,i,n){if(!n){i=+i,admin_sdr.pmi=i;var a=kiwi.modes_l[i];admin_sdr.pbm=a,console.log("config_pb_mode idx="+i+" mode="+a),admin_sdr.pbl=cfg.passbands[a].lo,admin_sdr.pbh=cfg.passbands[a].hi;var _=(admin_sdr.pbl+admin_sdr.pbh)/2;admin_sdr.pbc=ext_get_cfg_param("cfg.passbands."+a+".c",_,EXT_SAVE),admin_sdr.pbw=admin_sdr.pbh-admin_sdr.pbl,admin_sdr.pbc_lock=ext_get_cfg_param("cfg.passbands."+a+".lock",!1,EXT_SAVE),console.log("config_pb_mode: admin_sdr.pbc_lock="+admin_sdr.pbc_lock),w3_set_value("admin_sdr.pbl",admin_sdr.pbl),w3_set_value("admin_sdr.pbh",admin_sdr.pbh),w3_set_value("admin_sdr.pbc",admin_sdr.pbc),w3_set_value("admin_sdr.pbw",admin_sdr.pbw),w3_set_value("admin_sdr.pbc_lock",admin_sdr.pbc_lock),config_pb_val("pbl",admin_sdr.pbl,!1)}}function config_pb_val(e,i,n,a){if(!n){var _=e.slice(-3);i=+i;var t,r,d,o,c,s,l=ext_nom_sample_rate(),w=l?l/2:6e3,b=-w,m=w,p=admin_sdr.pbc_lock;switch(w3_show_hide("id-pbl-error",!1),w3_show_hide("id-pbh-error",!1),w3_show_hide("id-pbc-error",!1),w3_show_hide("id-pbw-error",!1),_){case"pbl":t=i,p?(d=admin_sdr.pbc,o=admin_sdr.pbh-t,s=t<=admin_sdr.pbc-1&&t>=b):(d=(t+admin_sdr.pbh)/2,o=admin_sdr.pbh-t,s=t<=admin_sdr.pbh-2&&t>=b),s&&(admin_sdr.pbl=t,admin_sdr.pbc=d,admin_sdr.pbw=o),console.log("pbl="+t+" ok="+s),w3_show_hide("id-pbl-error",!s);break;case"pbh":r=i,p?(d=admin_sdr.pbc,o=r-admin_sdr.pbl,s=r>=admin_sdr.pbc+1&&r<=m):(d=(admin_sdr.pbl+r)/2,o=r-admin_sdr.pbl,s=r>=admin_sdr.pbl+2&&r<=m),s&&(admin_sdr.pbh=r,admin_sdr.pbc=d,admin_sdr.pbw=o),console.log("pbh="+r+" ok="+s),w3_show_hide("id-pbh-error",!s);break;case"pbc":if(d=i,p){var g=admin_sdr.pbc-admin_sdr.pbl,u=admin_sdr.pbh-admin_sdr.pbc;console.log("delta_l="+g+" delta_h="+u),t=d-g,r=d+u,console.log(admin_sdr.pbl+"|"+admin_sdr.pbc+"|"+admin_sdr.pbh+" => "+t+"|"+d+"|"+r),s=d>t&&d<r}else r=d+(c=admin_sdr.pbw/2),s=(t=d-c)>=b&&r<=m;s&&(admin_sdr.pbl=t,admin_sdr.pbh=r,admin_sdr.pbc=d),console.log("pbc="+d+" ok="+s),w3_show_hide("id-pbc-error",!s);break;case"pbw":if(o=i,p){var h=o-admin_sdr.pbw,f=(admin_sdr.pbh-admin_sdr.pbc)/admin_sdr.pbw;g=Math.round(h*(1-f)),u=Math.round(h*f);console.log("delta_w="+h+" ratio_pbh="+f.toFixed(4)+" delta_l="+g+" delta_h="+u),t=admin_sdr.pbl-g,r=admin_sdr.pbh+u,console.log(admin_sdr.pbl+"|"+admin_sdr.pbc+"|"+admin_sdr.pbh+" => "+t+"|"+admin_sdr.pbc+"|"+r),s=o>=2&&t<r&&t<admin_sdr.pbc&&r>admin_sdr.pbc&&t>=b&&r<=m}else c=o/2,t=admin_sdr.pbc-c,r=admin_sdr.pbc+c,s=o>=2&&t>=b&&r<=m;s&&(admin_sdr.pbl=t,admin_sdr.pbh=r,admin_sdr.pbw=o),console.log("pbw="+o+" ok="+s),w3_show_hide("id-pbw-error",!s)}s&&(p&&console.log("LOCKED"),w3_set_value("admin_sdr.pbl",admin_sdr.pbl),w3_set_value("admin_sdr.pbh",admin_sdr.pbh),w3_set_value("admin_sdr.pbc",admin_sdr.pbc),w3_set_value("admin_sdr.pbw",admin_sdr.pbw),w3_checkbox_set("admin_sdr.pbc_lock",admin_sdr.pbc_lock),ext_set_cfg_param("cfg.passbands."+admin_sdr.pbm+".lo",admin_sdr.pbl,EXT_NO_SAVE),ext_set_cfg_param("cfg.passbands."+admin_sdr.pbm+".hi",admin_sdr.pbh,EXT_NO_SAVE),ext_set_cfg_param("cfg.passbands."+admin_sdr.pbm+".c",admin_sdr.pbc,EXT_NO_SAVE),ext_set_cfg_param("cfg.passbands."+admin_sdr.pbm+".lock",admin_sdr.pbc_lock,EXT_SAVE))}}function config_pbc_lock(e,i,n){n||(admin_sdr.pbc_lock=!!i,console.log("config_pbc_lock: cfg.passbands."+admin_sdr.pbm+".lock = "+admin_sdr.pbc_lock+" EXT_SAVE"),ext_set_cfg_param("cfg.passbands."+admin_sdr.pbm+".lock",admin_sdr.pbc_lock,EXT_SAVE))}function config_wfmin_cb(e,i,n){var a=(i=+i)<cfg.init.max_dB;a&&admin_int_cb(e,i,n),w3_show_hide("id-wfmin-error",!a)}function config_wfmax_cb(e,i,n){var a=(i=+i)>cfg.init.min_dB;a&&admin_int_cb(e,i,n),w3_show_hide("id-wfmax-error",!a)}function config_zoom_cb(e,i,n){var a=(i=+i)>=0&&i<=14;a&&admin_int_cb(e,i,n),w3_show_hide("id-zoom-error",!a)}function config_ident_len_cb(e,i,n){(i=+i)<16&&(i=16),i>64&&(i=64),admin_int_cb(e,i,n)}function config_OV_counts_cb(e,i,n,a){var _=1<<(i=+i);admin_int_cb(e,i),w3_set_label("S-meter OV if &ge; "+_+" ADC OV per 64k samples",e),ext_send("SET ov_counts="+_)}function overload_mute_cb(e,i,n,a){i=+i,admin_int_cb(e,i);var _="Passband overload mute "+i+" dBm";i>=-73&&(_+=" (S9+"+(i- -73)+")"),w3_set_label(_,e)}function config_clone_cb(e,i){var n;""==clone_host?n="please enter host to clone from":(n="cloning from "+clone_host,ext_send("SET config_clone host="+encodeURIComponent(clone_host)+" pwd=x"+encodeURIComponent(clone_pwd)+" files="+clone_files)),w3_innerHTML("id-config-clone-status",n)}function config_clone_status_cb(e){var i;0==e?(i="clone complete, restarting Kiwi",ext_send("SET restart"),admin_wait_then_reload(60,"Configuration cloned, restarting KiwiSDR server")):i=1280==e?"wrong password":256==e?"host unknown/unresponsive":"clone error #"+e,w3_innerHTML("id-config-clone-status",i)}function config_ext_clk_sel_cb(e,i){i=+i,admin_radio_YN_cb(e,i),w3_num_set_cfg_cb("cfg.clk_adj",0)}function config_ext_freq_cb(e,i,n){if(!n){var a=parseFloat(i);isNaN(a)?a=null:(a<70?a*=1e6:a<7e4&&(a*=1e3),((a=Math.floor(a))<65e6||a>69e6)&&(a=null)),admin_int_cb(e,a,n)}}function channels_html(){return w3_div("id-channels w3-hide","<hr>"+w3_third("w3-margin-bottom w3-text-teal w3-restart","w3-container","foo","bar","baz"))}function webpage_html(){var e="<hr>"+w3_divs("w3-margin-bottom/w3-container",w3_input("","Top bar title","index_html_params.RX_TITLE","","webpage_title_cb"))+w3_div("w3-container","<label><b>Top bar title HTML preview</b></label>",w3_div("id-webpage-title-preview w3-text-black w3-background-pale-aqua",""))+w3_divs("w3-margin-top w3-margin-bottom/w3-container",w3_input("","Owner info (appears in center of top bar; can use HTML like &lt;br&gt; for line break if line is too long)","owner_info","","webpage_owner_info_cb"))+w3_div("w3-container","<label><b>Owner info HTML preview</b></label>",w3_div("id-webpage-owner-info-preview w3-text-black w3-background-pale-aqua",""))+w3_divs("w3-margin-top w3-margin-bottom/w3-container",w3_input("","Status","status_msg","","webpage_status_cb"))+w3_div("w3-container","<label><b>Status HTML preview</b></label>",w3_div("id-webpage-status-preview w3-text-black w3-background-pale-aqua",""))+w3_divs("w3-margin-top/w3-container",w3_input("","Window/tab title","index_html_params.PAGE_TITLE","","webpage_string_cb")),i="<hr>"+w3_half("w3-margin-bottom","w3-container",w3_input("","Location","index_html_params.RX_LOC","","webpage_string_cb"),w3_input("",w3_label("w3-bold","Grid square (4 or 6 char) ")+w3_div("id-webpage-grid-check cl-admin-check w3-show-inline-block w3-green w3-btn w3-round-large"),"index_html_params.RX_QRA","","webpage_input_grid"))+w3_half("","w3-container",w3_input("","Altitude (ASL meters)","index_html_params.RX_ASL","","webpage_string_cb"),w3_input("",w3_label("w3-bold","Map (Google format or lat, lon) ")+w3_div("id-webpage-map-check cl-admin-check w3-show-inline-block w3-green w3-btn w3-round-large"),"index_html_params.RX_GMAP","","webpage_input_map"))+"<hr>"+w3_half("w3-margin-bottom","w3-container",w3_half("","",w3_div("",w3_label("w3-bold","Photo file"),'<input id="id-photo-file" type="file" accept="image/*" onchange="webpage_photo_file_upload()">',w3_div("id-photo-error","")),w3_checkbox_get_param("w3-restart w3-label-inline","Photo left margin","index_html_params.RX_PHOTO_LEFT_MARGIN","admin_bool_cb",!0)),w3_input("","Photo maximum height (pixels)","index_html_params.RX_PHOTO_HEIGHT","","webpage_photo_height_cb"))+w3_half("","w3-container",w3_input("","Photo title","index_html_params.RX_PHOTO_TITLE","","webpage_string_cb"),w3_input("","Photo description","index_html_params.RX_PHOTO_DESC","","webpage_string_cb")),n="<hr>"+w3_half("w3-margin-bottom w3-text-teal","w3-container",w3_divs("/w3-center w3-tspace-8",w3_div("","<b>Web server caching?</b>"),w3_switch("","Yes","No","webserver_caching",cfg.webserver_caching,"admin_radio_YN_cb"),w3_text("w3-text-black w3-center",'Set "No" when there are caching problems in your <br>network path, e.g. user interface icons don\'t load.')))+"<hr>"+w3_div("w3-container",w3_textarea_get_param("w3-input-any-change|width:100%",w3_div("",w3_text("w3-bold w3-text-teal","Additional HTML/Javascript for HTML &lt;head&gt; element (e.g. Google analytics or user customization)"),w3_text("w3-text-black","Press enter(return) key while positioned at end of text to submit data.")),"index_html_params.HTML_HEAD",10,100,"webpage_string_cb",""))+"<hr>";return w3_div("id-webpage w3-text-teal w3-hide",e+i+n)}function webpage_input_grid(e,i){webpage_string_cb(e,i),webpage_update_check_grid()}function webpage_update_check_grid(){var e=ext_get_cfg_param("index_html_params.RX_QRA");w3_el("webpage-grid-check").innerHTML='<a href="http://www.levinecentral.com/ham/grid_square.php?Grid='+e+'" target="_blank">check grid</a>'}function webpage_input_map(e,i){webpage_string_cb(e,i.trim()),webpage_update_check_map()}function webpage_update_check_map(){var e=kiwi_decodeURIComponent("RX_GMAP",ext_get_cfg_param("index_html_params.RX_GMAP"));w3_el("webpage-map-check").innerHTML='<a href="https://google.com/maps/place/'+e+'" target="_blank">check map</a>'}function webpage_photo_uploaded(e){var i;0==(i=null!=e.AJAX_error?-1:e.r)&&webpage_string_cb("index_html_params.RX_PHOTO_FILE","kiwi.config/photo.upload");var n,a=w3_el("photo-error");switch(i){case-1:n="Communication error";break;case 0:n="Upload successful";break;case 1:n="Authentication failed";break;case 2:n="Not an image file?";break;case 3:n="Unable to determine file type";break;case 4:n="File too large";break;default:n="Undefined error?"}a.innerHTML=n,w3_add(a,0==i?"w3-text-green":"w3-text-red"),w3_show_block(a)}function webpage_photo_file_upload(){ext_get_authkey(function(e){webpage_photo_file_upload2(e)})}function webpage_photo_file_upload2(e){var i=w3_el("id-photo-file");i.innerHTML="Uploading...";var n=i.files[0],a=new FormData;a.append("photo",n,n.name);var _=w3_el("photo-error");w3_hide(_),w3_remove(_,"w3-text-red"),w3_remove(_,"w3-text-green"),kiwi_ajax_send(a,"/PIX?"+e,"webpage_photo_uploaded")}function webpage_title_cb(e,i){webpage_string_cb(e,i),w3_el("id-webpage-title-preview").innerHTML=admin_preview_status_box("RX_TITLE_2",cfg.index_html_params.RX_TITLE)}function webpage_owner_info_cb(e,i){webpage_string_cb(e,i),w3_el("id-webpage-owner-info-preview").innerHTML=admin_preview_status_box("owner_info_2",cfg.owner_info)}function webpage_status_cb(e,i){w3_string_set_cfg_cb(e,i),w3_el("id-webpage-status-preview").innerHTML=admin_preview_status_box("webpage_status_2",cfg.status_msg)}function webpage_focus(){admin_set_decoded_value("index_html_params.RX_TITLE"),w3_el("id-webpage-title-preview").innerHTML=admin_preview_status_box("RX_TITLE_1",cfg.index_html_params.RX_TITLE),admin_set_decoded_value("status_msg"),w3_el("id-webpage-status-preview").innerHTML=admin_preview_status_box("webpage_status_1",cfg.status_msg),admin_set_decoded_value("index_html_params.PAGE_TITLE"),admin_set_decoded_value("index_html_params.RX_LOC"),admin_set_decoded_value("index_html_params.RX_QRA"),admin_set_decoded_value("index_html_params.RX_ASL"),admin_set_decoded_value("index_html_params.RX_GMAP"),admin_set_decoded_value("index_html_params.RX_PHOTO_HEIGHT"),admin_set_decoded_value("index_html_params.RX_PHOTO_TITLE"),admin_set_decoded_value("index_html_params.RX_PHOTO_DESC"),admin_set_decoded_value("owner_info"),w3_el("id-webpage-owner-info-preview").innerHTML=admin_preview_status_box("owner_info_1",cfg.owner_info),webpage_update_check_grid(),webpage_update_check_map()}function webpage_string_cb(e,i){w3_string_set_cfg_cb(e,i),ext_send("SET reload_index_params")}function webpage_photo_height_cb(e,i){i=parseInt(i),isNaN(i)?(i=ext_get_cfg_param(e),w3_set_value(e,i)):(i=w3_clamp(i,0,4e3,0),w3_set_value(e,i),w3_num_set_cfg_cb(e,i),ext_send("SET reload_index_params"))}function kiwi_reg_html(){var e=w3_div("",w3_div("w3-margin-T-10 w3-valign",'<header class="w3-container w3-yellow"><h5>More information on <a href="http://kiwisdr.com/quickstart/index.html#id-config-kiwi-reg" target="_blank">kiwisdr.com</a><br><br>To list your Kiwi on <a href="http://rx.kiwisdr.com" target="_blank">rx.kiwisdr.com</a> edit the fields below and set the "<i>Register</i>" switch to <b>Yes</b>. Look for a successful status result within a few minutes.<br>The "<i>Location (lat, lon)</i>" field must be set properly for your Kiwi to be listed in the correct location on <a href="http://map.kiwisdr.com" target="_blank">map.kiwisdr.com</a></h5></header>'))+"<hr>"+w3_divs("w3-margin-bottom w3-container w3-center",w3_div("",'<b>Register on <a href="http://rx.kiwisdr.com" target="_blank">rx.kiwisdr.com</a>?</b> '+w3_switch("","Yes","No","adm.kiwisdr_com_register",adm.kiwisdr_com_register,"kiwisdr_com_register_cb")),w3_div("id-kiwisdr_com-reg-status-container",w3_div("w3-container",w3_label("w3-show-inline-block w3-margin-R-16 w3-text-teal","kiwisdr.com registration status:")+w3_div("id-kiwisdr_com-reg-status w3-show-inline-block w3-text-black","")))),i="<hr>"+w3_half("w3-margin-bottom w3-restart","w3-container",w3_input("","Name","rx_name","","w3_string_set_cfg_cb"),w3_input("","Location","rx_location","","w3_string_set_cfg_cb"))+w3_half("w3-margin-bottom w3-restart","w3-container",w3_input("","Admin email","admin_email","","w3_string_set_cfg_cb"),w3_input("","Antenna","rx_antenna","","w3_string_set_cfg_cb"))+w3_third("w3-margin-bottom w3-restart","w3-container",w3_input("",w3_label("w3-bold","Grid square (4/6 char) ")+w3_div("id-public-grid-check cl-admin-check w3-show-inline-block w3-green w3-btn w3-round-large")+" "+w3_div("id-public-grid-set cl-admin-check w3-blue w3-btn w3-round-large w3-hide","set from GPS"),"rx_grid","","sdr_hu_input_grid"),w3_div("",w3_input("",w3_label("w3-bold","Location (lat, lon) ")+w3_div("id-public-gps-check cl-admin-check w3-show-inline-block w3-green w3-btn w3-round-large")+" "+w3_div("id-public-gps-set cl-admin-check w3-blue w3-btn w3-round-large w3-hide","set from GPS"),"rx_gps","","public_check_gps_cb"),w3_div("w3-text-black","Format: (nn.nnnnnn, nn.nnnnnn)")),w3_input_get("","Altitude (ASL meters)","rx_asl","admin_int_cb"))+"<hr>"+w3_half("w3-margin-bottom","w3-container","<b>Display owner/admin email link on KiwiSDR main page?</b> "+w3_switch("","Yes","No","contact_admin",cfg.contact_admin,"admin_radio_YN_cb"),"")+"<hr>"+w3_half("w3-margin-bottom","w3-container",w3_div("",w3_input_get("","Coverage frequency low (kHz)","sdr_hu_lo_kHz","admin_int_cb"),w3_div("w3-text-black",'These two settings effect the frequency coverage label displayed on rx.kiwisdr.com <br>e.g. when set to 0 and 30000 "HF" is shown. If you\'re using a transverter <br>then appropriate entries will cause "2m" or "70cm" to be shown. Other labels will be <br>shown if you limit the range at HF due to antenna or filtering limitations.')),w3_input_get("","Coverage frequency high (kHz)","sdr_hu_hi_kHz","admin_int_cb"))+"<hr>";return w3_div("id-sdr_hu w3-text-teal w3-hide",e+i)}function kiwisdr_com_register_cb(e,i){var n,a;i=+i;var _=""==cfg.server_url,t=""!=adm.user_password&&0==cfg.chan_no_pwd,r=""==cfg.rx_gps||"(0.000000, 0.000000)"==cfg.rx_gps||"(0.000000%2C%200.000000)"==cfg.rx_gps;i==w3_SWITCH_YES_IDX&&(_||t||r)?(_?n='Error, you must first setup a valid Kiwi connection URL on the admin "connect" tab':t?n='Error, must have at least one user channel that doesn\'t require a password (see admin "security" tab)':r&&(n='Error, you must first set a valid entry in the "<i>Location (lat, lon)</i>" field'),a="#ffeb3b",w3_switch_set_value(e,w3_SWITCH_NO_IDX),i=w3_SWITCH_NO_IDX):i==w3_SWITCH_YES_IDX?(n="(waiting for kiwisdr.com response, can take several minutes in some cases)",a="hsl(180, 100%, 95%)"):(n="(registration not enabled)",a="hsl(180, 100%, 95%)",w3_switch_set_value(e,w3_SWITCH_NO_IDX)),w3_innerHTML("id-kiwisdr_com-reg-status",n),w3_color("id-kiwisdr_com-reg-status",null,a),admin_radio_YN_cb(e,i)}function sdr_hu_register_cb(e,i){(i=+i)==w3_SWITCH_YES_IDX&&""==cfg.server_url?('Error, you must first setup a valid Kiwi connection URL on the admin "connect" tab',"#ffeb3b",w3_switch_set_value(e,w3_SWITCH_NO_IDX),i=w3_SWITCH_NO_IDX):i==w3_SWITCH_YES_IDX?"(waiting for sdr.hu response, can take several minutes in some cases)":"(registration not enabled)",admin_radio_YN_cb(e,i)}function sdr_hu_focus(){admin_set_decoded_value("rx_name"),admin_set_decoded_value("rx_location"),admin_set_decoded_value("rx_antenna"),admin_set_decoded_value("rx_grid"),admin_set_decoded_value("rx_gps"),admin_set_decoded_value("admin_email"),public_check_gps_cb("rx_gps",kiwi_decodeURIComponent("rx_gps",ext_get_cfg_param("rx_gps")),!0),public_update_check_grid(),public_update_check_map(),w3_el("id-public-grid-set").onclick=function(){var e=admin.reg_status.grid;w3_set_value("rx_grid",e),w3_input_change("rx_grid","sdr_hu_input_grid")},w3_el("id-public-gps-set").onclick=function(){var e="("+admin.reg_status.lat+", "+admin.reg_status.lon+")";w3_set_value("rx_gps",e),w3_input_change("rx_gps","public_check_gps_cb")},ext_send("SET public_update"),sdr_hu_interval=setInterval(function(){ext_send("SET public_update")},5e3),kiwisdr_com_register_cb("adm.kiwisdr_com_register",adm.kiwisdr_com_register?w3_SWITCH_YES_IDX:w3_SWITCH_NO_IDX),sdr_hu_register_cb("adm.sdr_hu_register",adm.sdr_hu_register?w3_SWITCH_YES_IDX:w3_SWITCH_NO_IDX)}function sdr_hu_input_grid(e,i){w3_string_set_cfg_cb(e,i),public_update_check_grid()}function public_update_check_grid(){var e=ext_get_cfg_param("rx_grid");w3_el("id-public-grid-check").innerHTML='<a href="http://www.levinecentral.com/ham/grid_square.php?Grid='+e+'" target="_blank">check grid</a>'}function public_check_gps_cb(e,i,n){for(var a=0,_=0,t=/([-]?\d*\.?\d+)/g,r=0;r<2;r++){var d=t.exec(i);d&&(r?_=parseFloat(d[0]):a=parseFloat(d[0]))}"(-37.631120, 176.172210)"!=(i="("+a.toFixed(6)+", "+_.toFixed(6)+")")&&"(-37.631120%2C%20176.172210)"!=i||(i="(0.000000, 0.000000)"),"(0.000000, 0.000000)"==i?(w3_flag("rx_gps"),kiwisdr_com_register_cb("adm.kiwisdr_com_register",w3_SWITCH_NO_IDX)):w3_unflag("rx_gps"),w3_string_set_cfg_cb(e,i,n),w3_set_value(e,i),public_update_check_map()}function public_update_check_map(){var e=kiwi_decodeURIComponent("rx_gps",ext_get_cfg_param("rx_gps"));e=e.substring(1,e.length-1),w3_el("id-public-gps-check").innerHTML='<a href="https://google.com/maps/place/'+e+'" target="_blank">check map</a>'}function sdr_hu_blur(e){kiwi_clearInterval(sdr_hu_interval)}function public_update(e){var i=decodeURIComponent(e),n=kiwi_JSON_parse("public_update",i);n&&(admin.reg_status=n),adm.kiwisdr_com_register&&null!=admin.reg_status.kiwisdr_com&&""!=admin.reg_status.kiwisdr_com&&w3_innerHTML("id-kiwisdr_com-reg-status","rx.kiwisdr.com registration: successful"),null!=admin.reg_status.lat&&(w3_show_inline_block("id-public-grid-set"),w3_show_inline_block("id-public-gps-set"))}function dx_html(){if(!admin_sdr.dx_enabled)return w3_div("id-dx w3-hide",w3_div("w3-container w3-margin-top","TODO.."));isUndefined(cfg.bands)?(bandwidth=1e6*[30,32][cfg.max_freq],zoom_nom=ZOOM_NOMINAL,bands_init(),console.log("BANDS: saving new cfg.bands"),cfg_save_json("config.js","cfg.bands")):(console.log("BANDS: using stored cfg.bands"),bands_addl_info());return w3_div("id-dx w3-hide",w3_inline("w3-margin-T-16 w3-halign-space-between/",w3_inline("/w3-margin-between-16",w3_button("w3-font-fixed w3-aqua w3-circle w3-circle-pad","+","dx_expand_cb",0),w3_text("w3-text-teal w3-bold","Band bars"),w3_text("id-band_bar-saved w3-margin-left w3-padding-medium w3-text-black w3-hide","Changes saved")),w3_inline("",w3_text("w3-margin-left w3-text-black","Hover over"),w3_icon("w3-link-darker-color","fa-info-circle",20),w3_text("w3-text-black","&nbsp;for info"))),w3_div("id-band_bar-container w3-container w3-hide w3-margin-top w3-margin-bottom w3-card-8 w3-round-xlarge w3-pale-blue",w3_div("id-band_bar-list-legend w3-margin-R-15"),w3_div("id-band_bar-list w3-margin-bottom w3-black-box w3-scroll-y|height:32vh")),w3_inline("w3-margin-T-24 w3-halign-space-between/",w3_inline("/w3-margin-between-16",w3_button("w3-font-fixed w3-aqua w3-circle w3-circle-pad","-","dx_expand_cb",1),w3_text("w3-text-teal w3-bold","DX labels"),w3_text("id-dx-saved w3-margin-left w3-padding-medium w3-text-black w3-hide","Changes saved")),w3_input("w3-text-teal/w3-label-inline/w3-padding-small|width:300px","Filter","dx.o.filter","","dx_filter_cb")),w3_div("id-dx-list-container w3-container w3-margin-top w3-margin-bottom w3-card-8 w3-round-xlarge w3-pale-blue",w3_div("id-dx-list-legend w3-margin-R-15"),w3_div('id-dx-list w3-margin-bottom w3-black-box w3-scroll-y|height:32vh|onscroll="dx_list_scroll();"')))}function dx_expand_cb(e,i){i=+i;var n=w3_el(e),a="-"==n.innerText;w3_hide2(i?"id-dx-list-container":"id-band_bar-container",a),n.innerText=a?"+":"-"}function dx_focus(){admin_sdr.dx_enabled&&(w3_innerHTML("id-band_bar-list-legend",""),w3_innerHTML("id-band_bar-list",""),w3_innerHTML("id-dx-list-legend",""),w3_innerHTML("id-dx-list",w3_div("w3-show-inline-block w3-relative|top:45%;left:45%",w3_icon("","fa-refresh fa-spin",48,"black"),w3_div("id-dx-list-count w3_text_black"))),console.log("### dx_focus: SET GET_DX_JSON"),ext_send("SET GET_DX_JSON"))}function dx_json(e){admin_sdr.dx_enabled&&(console.log("### dx_json: entries="+e),w3_innerHTML("id-dx-list-count","loading "+e+" entries"),band_bar_json_cb(),setTimeout(function(){dx_json_cb(e)},500))}function dx_blur(){console.log("dx_blur"),band_bar_save()}function dx_btn(e){return"w3-font-fixed w3-circle w3-circle-pad-small "+e}function dx_spacer(){return w3_div("w3-font-fixed w3-circle-pad-small w3-pale-blue","&nbsp;")}function band_bar_json_cb(){var e,i,n=[],a="w3-link-darker-color w3-help",_="Band name "+w3_icon(a+"||title="+dq("typ bar baz\none two xxx"),"fa-info-circle",20),t="Type "+w3_icon(a+"||title="+dq("typ bar baz\none two xxx"),"fa-info-circle",20),r="ITU / Visibility "+w3_icon(a+"||title="+dq("itu bar baz\none two xxx"),"fa-info-circle",20),d="Chan "+w3_icon(a+"||title="+dq("itu bar baz\none two xxx"),"fa-info-circle",20),o="Select freq/mode "+w3_icon(a+"||title="+dq("itu bar baz\none two xxx"),"fa-info-circle",20);for(e=-1;e<cfg.bands.length;e++){i=-1!=e?cfg.bands[e]:{};var c=function(i){return-1==e?"w3-hide":i},s=function(i){return-1==e?i:""},l="band_bar_float_cb|",w=w3_obj_key_seq(kiwi.svc,i.svc),b=i.itu>0?i.itu:0,m=w3_inline_percent("w3-valign w3-text-black/w3-margin-T-8 w3-hspace-16 w3-margin-RE-16",w3_inline("w3-margin-L-8",-1==e?dx_spacer():w3_button(dx_btn("w3-css-lime"),"+","band_bar_add_cb",e),-1==e?dx_spacer():w3_button(dx_btn("w3-css-red"),"-","band_bar_del_cb",e)),2,w3_input(c("w3-padding-small||size=8"),s("Min kHz"),e+"_bands.min",i.min,l+"0"),10,w3_input(c("w3-padding-small||size=8"),s("Max kHz"),e+"_bands.max",i.max,l+"1"),10,w3_input(c("w3-padding-small"),s(_),e+"_bands.n",i.name,"band_bar_name_cb"),25,w3_select(c("w3-text-red"),s(t),"",e+"_bands.t",w,kiwi.svc,"band_bar_select_cb","t"),10,w3_select(c("w3-text-red"),s(r),"",e+"_bands.i",b,kiwi.ITU_s,"band_bar_select_cb","i"),25,w3_input(c("w3-padding-small||size=6"),s(d),e+"_bands.c",i.chan,l+"2"),7,w3_input(c("w3-padding-small||size=8"),s(o),e+"_bands.s",i.sel,"band_bar_sel_cb"),15);-1==e?w3_innerHTML("id-band_bar-list-legend",m):n[e]=m}w3_innerHTML("id-band_bar-list",n.join(""))}function band_bar_sched_save(){kiwi_clearTimeout(admin_sdr.cfg_save_timeout),admin_sdr.cfg_save_timeout=setTimeout(function(){band_bar_save()},2e3),admin_sdr.cfg_save_sched=!0}function band_bar_save(e){if(kiwi_clearTimeout(admin_sdr.cfg_save_timeout),e||1==admin_sdr.cfg_save_sched){admin_sdr.cfg_save_sched=!1,console.log("BANDS: saving cfg.bands"),w3_hide2("id-band_bar-saved",!1);w3_flash_fade("id-band_bar-saved","cyan",50,1e3,"white"),setTimeout(function(){w3_hide2("id-band_bar-saved")},1250),cfg_save_json("band_bar_save","cfg.bands")}}function band_bar_add_cb(e,i,n){if(!n){var a=+i;if(console.log("band_bar_add_cb path="+e+" i="+a),!(a<0||a>=cfg.bands.length)){var _={min:0,max:0,name:"",svc:"B",itu:kiwi.ITU_ANY,sel:"",chan:0};cfg.bands.splice(a+1,0,_),band_bar_save(!0),bands_addl_info(),band_bar_json_cb()}}}function band_bar_del_cb(e,i,n){if(!n){var a=+i;console.log("band_bar_del_cb path="+e+" i="+a),a<0||a>=cfg.bands.length||(cfg.bands.splice(a,1),band_bar_save(!0),bands_addl_info(),band_bar_json_cb())}}function band_bar_float_cb(e,i,n,a){if(!n){var _=parseInt(e);if(!(_<0||_>=cfg.bands.length)){var t=+a[1],r=cfg.bands[_][kiwi.cfg_fields[t]];i=parseFloat(i),console.log("band_bar_float_cb path="+e+" val="+i+" i="+_+" which="+t+" prior="+r),i=+i.toFixed(3),isNumber(i)||(i=r),w3_set_value(e,i||""),0==t?(console.log("cfg.bands["+_+"].min="+i),cfg.bands[_].min=i):1==t?(console.log("cfg.bands["+_+"].max="+i),cfg.bands[_].max=i):2==t&&(console.log("cfg.bands["+_+"].chan="+i),cfg.bands[_].chan=i),band_bar_sched_save()}}}function band_bar_name_cb(e,i,n){if(!n){var a=parseInt(e);console.log("band_bar_name_cb path="+e+" val="+i+" i="+a),a<0||a>=cfg.bands.length||(cfg.bands[a].name=i,band_bar_sched_save())}}function band_bar_sel_cb(e,i,n){if(!n){var a=parseInt(e);console.log("band_bar_sel_cb path="+e+" val="+i+" i="+a),a<0||a>=cfg.bands.length||(cfg.bands[a].sel=i,band_bar_sched_save())}}function band_bar_select_cb(e,i,n,a){if(!n){var _=parseInt(e);i=+i,console.log("band_bar_select_cb path="+e+" val="+i+" i="+_+" which="+a),_<0||_>=cfg.bands.length||("t"==a?(console.log("cfg.bands["+_+"].svc="+kiwi.svc_s[i]),cfg.bands[_].svc=kiwi.svc_s[i]):"i"==a&&(console.log("cfg.bands["+_+"].itu="+i),cfg.bands[_].itu=i),band_bar_sched_save())}}function dx_json_render(e){var i,n,a=dx.o.arr;for(i=dx.o.last_start;i<=dx.o.last_end;i++)a[i]=w3_div("cl-dx",i);dx.o.last_pb=[];for(n=0;n<e.length;n++){var _,t,r,d,o=null,c="",s="",l=0,w="",b=function(e){return-1==i?"w3-hide":e},m=function(e){return-1==i?e:""};if(-1!=(i=n?e[n].g:-1)){_=(o=e[n]).f,t=o.x&dx.DX_MODE,l=(o.x&dx.DX_TYPE)>>dx.DX_TYPE_SFT,r=kiwi_decodeURIComponent("dx_id",o.i),o.n&&(c=kiwi_decodeURIComponent("dx_no",o.n)),o.p&&(w=kiwi_decodeURIComponent("dx_ext",o.p)),d=o.o;var p=o.lo,g=o.hi;(p||g)&&(s=p==-g?(2*Math.abs(g)).toFixed(0):p.toFixed(0)+", "+g.toFixed(0),dx.o.last_pb[i]=[p,g])}var u=w3_inline_percent("w3-valign w3-text-black/w3-margin-T-8 w3-hspace-16 w3-margin-RE-16",w3_inline("w3-margin-L-8",-1==i?dx_spacer():w3_button(dx_btn("w3-css-lime"),"+","dx_admin_add_cb",i),-1==i?dx_spacer():w3_button(dx_btn("w3-css-red"),"-","dx_admin_del_cb",i)),4,w3_input(b("w3-padding-small||size=8"),m("Freq kHz"),"dx.o.f_"+i,_,"dx_num_cb"),19,w3_select(b("w3-text-red"),m("Mode"),"","dx.o.m_"+i,t,kiwi.modes_u,"dx_sel_cb"),15,w3_input(b("w3-padding-small||size=4"),m("Passband Hz"),"dx.o.pb_"+i,s,"dx_passband_cb"),25,w3_select(b("w3-text-red"),m("Type"),"","dx.o.y_"+i,l,dx.stored_types,"dx_sel_cb"),25,w3_input(b("w3-padding-small||size=2"),m("Offset Hz"),"dx.o.o_"+i,d,"dx_num_cb"),18,w3_input(b("w3-padding-small"),m("Ident"),"dx.o.i_"+i,r,"dx_string_cb"),40,w3_input(b("w3-padding-small"),m("Notes"),"dx.o.n_"+i,c,"dx_string_cb"),40,w3_input(b("w3-padding-small"),m("Extension"),"dx.o.p_"+i,w,"dx_string_cb"),25);-1==i?w3_innerHTML("id-dx-list-legend",u):a[i]=u}w3_innerHTML("id-dx-list",a.join("")),dx.o.last_start=e[1].g,dx.o.last_end=e[e.length-1].g}function dx_json_cb(e){var i=[];dx.o.len=e,dx.o.arr=i,dx.o.last_start=dx.o.last_end=0;for(var n=0;n<e;n++)i[n]=w3_div("cl-dx",n);w3_innerHTML("id-dx-list",i.join("")),dx_list_scroll()}function dx_list_scroll(){var e=w3_scrolledPosition("id-dx-list");kiwi_clearTimeout(dx.scroll_timeout),dx.scroll_timeout=setTimeout(function(){dx_list_scroll_done(e)},100)}function dx_list_scroll_done(e){var i=w3_el("id-dx-list"),n=Math.round(i.clientHeight/37.5),a=Math.round(e*(dx.o.len-n)),_=(a=Math.max(0,a-1))+n;_=Math.min(_+1,dx.o.len),ext_send("SET MARKER idx1="+a+" idx2="+_)}function dx_filter_cb(e,i){console.log("dx_filter_cb p="+i)}function extensions_html(){return w3_div("id-extensions w3-hide w3-section",w3_sidenav("id-extensions-nav"),w3_div("id-extensions-config"))}function extensions_focus(){w3_el("id-nav-wspr")&&w3_click_nav(kiwi_toggle(toggle_e.FROM_COOKIE|toggle_e.SET,"wspr","wspr","last_admin_ext_nav"),"extensions_nav")}function extensions_blur(){ext_cur_nav&&w3_call(ext_cur_nav+"_config_blur")}function extensions_nav_focus(e,i){writeCookie("last_admin_ext_nav",e),w3_show(e+"-container"),w3_call(e+"_config_focus"),ext_cur_nav=e}function extensions_nav_blur(e,i){w3_hide(e+"-container"),w3_call(e+"_config_blur")}var ext_seq=0;function ext_admin_config(e,i,n,a){null==a&&(a=null);var _=ext_seq%admin_colors.length;w3_el("id-extensions-nav").innerHTML+=w3_nav(admin_colors[_]+" w3-border",i,e,"extensions_nav"),ext_seq++,w3_el("id-extensions-config").innerHTML+=w3_div("id-"+e+"-container w3-hide|width:95%",n)}function ext_config_html(e,i,n,a,_){var t=e.ext_name;e.enable=ext_get_cfg_param(i+".enable",!0,EXT_SAVE),ext_admin_config(t,n,w3_div("id-"+t+" w3-text-teal w3-hide",w3_col_percent("w3-valign/",w3_div("w3-bold",a),40,w3_inline("",w3_div("w3-bold w3-margin-R-8","User enabled?"),w3_switch("","Yes","No",i+".enable",e.enable,"admin_radio_YN_cb"),w3_div("w3-text-black w3-margin-L-32","Local connections exempt.")))+"<hr>"+(_||"")))}


